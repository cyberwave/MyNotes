# 一、忘记密码
## 1. 数据库存储设计
```sql
CREATE TABLE IF NOT EXISTS tb_forgot_password(
    retrieve_passwd_no int, -- 找回密码编号
    login_info_id int, -- 登录编号
    expired varchar(50), -- 过期时间
    random_md5 varchar(50), -- 随机串
    type varchar(64),  -- 类型
)
```
* 密码找回编号：有时用户可能点击了多次，标示每一次的编号
* 编号： 与登录用户的id，用于标示是哪个用户点击了忘记密码（忘记密码时，需要输入用户名或邮箱，如果忘记用户名，可以只填写注册邮件，以通过邮箱找到对应的用户 -- 找回用户）
* 过期时间： 也即有效期，即在忘记密码邮件发送到指定邮箱时，多长时间内有效
* 随机串： 用来唯一标注邮件链接，可以要根据时间戳然后用md5进行加密
* 类型： 可以用来标示不同的链接，也可以标志忘记密码找加方式，如手机，邮件等，根据需要
还可以添加逻辑删除标志及更新时间。如果逻辑删除后达到某一时间长度，则物理删除或移入历史表中。
## 2. 邮件发送
在用户点击忘记密码前，需要首先输入用户名或邮箱，以便后台对用户进行校验以及锁定。并发送邮件到指定邮箱。
## 3. 密码重置
在用户点击后，需要到库中查找该用户及链接，然后显示重置密码页面。重置成功后，删除该链接，或标示该链接失效，或增加使用次数。

参考:
1. [忘记密码功能的安全实现(邮件方式)](https://www.cnblogs.com/shenliang123/p/3266770.html) 
2. [有利网任意用户密码重置及修补](http://www.2cto.com/article/201305/215934.html)